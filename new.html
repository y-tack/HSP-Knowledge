---
layout: default
title: æ–°è¦è¨˜äº‹ã‚’ä½œæˆ
---

<style>
.edit-page-container {
  max-width: 1400px;
  margin: 0 auto;
}

.edit-header {
  background: #fff;
  border-radius: 8px;
  padding: 20px 24px;
  margin-bottom: 16px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.06);
}

.edit-header h2 {
  margin: 0 0 8px;
  font-size: 24px;
}

.edit-header p {
  margin: 0;
  color: #666;
  font-size: 14px;
}

.edit-controls {
  display: flex;
  gap: 8px;
  margin-bottom: 16px;
}

.edit-controls button,
.edit-controls a {
  padding: 10px 20px;
  border-radius: 6px;
  font-size: 14px;
  font-weight: bold;
  text-decoration: none;
  border: none;
  cursor: pointer;
  transition: background 0.2s;
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.save-button {
  background: #28a745;
  color: #fff;
}

.save-button:hover {
  background: #218838;
}

.cancel-button {
  background: #6c757d;
  color: #fff;
}

.cancel-button:hover {
  background: #5a6268;
  text-decoration: none;
}

.editor-container {
  background: #fff;
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.06);
}

#editor {
  min-height: 600px;
}

/* Toast UI Editoræ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆè¨­å®š */
.toastui-editor-defaultUI,
.toastui-editor-md-container,
.toastui-editor-ww-container {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Yu Gothic", sans-serif !important;
}

.toastui-editor-contents {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Yu Gothic", sans-serif !important;
}

.ProseMirror {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Yu Gothic", sans-serif !important;
}

.metadata-editor {
  background: #f8f9fa;
  border-radius: 6px;
  padding: 16px;
  margin-bottom: 20px;
  border: 1px solid #dee2e6;
}

.metadata-editor h3 {
  margin: 0 0 12px;
  font-size: 16px;
  color: #495057;
}

.metadata-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}

.metadata-field {
  display: flex;
  flex-direction: column;
}

.metadata-field label {
  font-size: 12px;
  font-weight: bold;
  color: #6c757d;
  margin-bottom: 4px;
}

.metadata-field input,
.metadata-field textarea {
  padding: 8px 10px;
  border: 1px solid #ced4da;
  border-radius: 4px;
  font-size: 14px;
  font-family: system-ui, -apple-system, sans-serif;
}

.metadata-field input:focus,
.metadata-field textarea:focus {
  outline: none;
  border-color: #1a73e8;
  box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.1);
}

.metadata-field.full-width {
  grid-column: 1 / -1;
}

@media (max-width: 768px) {
  .metadata-grid {
    grid-template-columns: 1fr;
  }
}
</style>

<div class="edit-page-container">
  <div class="edit-header">
    <h2>âœ¨ æ–°è¦è¨˜äº‹ã‚’ä½œæˆ</h2>
    <p>è¨˜äº‹ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ã€WYSIWYGã‚¨ãƒ‡ã‚£ã‚¿ã§æœ¬æ–‡ã‚’æ›¸ãã¾ã—ã‚‡ã†</p>
  </div>

  <div class="edit-controls">
    <button id="save-button" class="save-button">
      ğŸ’¾ GitHubã§ä¿å­˜
    </button>
    <a href="{{ '/' | relative_url }}" class="cancel-button">
      âŒ ã‚­ãƒ£ãƒ³ã‚»ãƒ«
    </a>
  </div>

  <div class="editor-container">
    <!-- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ‡ã‚£ã‚¿ -->
    <div class="metadata-editor">
      <h3>ğŸ“‹ è¨˜äº‹æƒ…å ±</h3>
      <div class="metadata-grid">
        <div class="metadata-field full-width">
          <label for="meta-filename">ãƒ•ã‚¡ã‚¤ãƒ«åï¼ˆè‹±æ•°å­—ã€ãƒã‚¤ãƒ•ãƒ³ã€ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã®ã¿ï¼‰</label>
          <input type="text" id="meta-filename" placeholder="ä¾‹: my-first-article">
          <small style="color: #666; font-size: 11px; margin-top: 4px;">â€» æ—¥ä»˜ã¨mdã¯è‡ªå‹•ä»˜ä¸ã•ã‚Œã¾ã™ï¼ˆä¾‹: 2025-12-09-my-first-article.mdï¼‰</small>
        </div>
        <div class="metadata-field">
          <label for="meta-title">ã‚¿ã‚¤ãƒˆãƒ« <span style="color: red;">*</span></label>
          <input type="text" id="meta-title" placeholder="è¨˜äº‹ã®ã‚¿ã‚¤ãƒˆãƒ«">
        </div>
        <div class="metadata-field">
          <label for="meta-author">è‘—è€… <span style="color: red;">*</span></label>
          <input type="text" id="meta-author" placeholder="è‘—è€…å">
        </div>
        <div class="metadata-field full-width">
          <label for="meta-tags">ã‚¿ã‚°ï¼ˆæ¨å¥¨ã‚¿ã‚°ã‹ã‚‰é¸æŠ + è‡ªç”±ã«è¿½åŠ å¯ï¼‰<span style="color: red;">*</span></label>
          <div style="background: #fff; padding: 10px; border: 1px solid #ddd; border-radius: 3px; margin: 5px 0;">
            <p style="font-size: 12px; color: #666; margin: 5px 0;"><strong>ğŸ¯ å¯¾è±¡åˆ†é‡</strong></p>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 12px;">
              <label style="display: flex; align-items: center;"><input type="checkbox" name="meta-tag" value="HSP3" style="margin-right: 5px;"> HSP3</label>
              <label style="display: flex; align-items: center;"><input type="checkbox" name="meta-tag" value="ã‚²ãƒ¼ãƒ åˆ¶ä½œ" style="margin-right: 5px;"> ã‚²ãƒ¼ãƒ åˆ¶ä½œ</label>
              <label style="display: flex; align-items: center;"><input type="checkbox" name="meta-tag" value="3D" style="margin-right: 5px;"> 3D</label>
              <label style="display: flex; align-items: center;"><input type="checkbox" name="meta-tag" value="ãƒ©ã‚¤ãƒ–ãƒ©ãƒª" style="margin-right: 5px;"> ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</label>
            </div>

            <p style="font-size: 12px; color: #666; margin: 5px 0;"><strong>ğŸ“š ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—</strong></p>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 12px;">
              <label style="display: flex; align-items: center;"><input type="checkbox" name="meta-tag" value="Tips" style="margin-right: 5px;"> Tips</label>
              <label style="display: flex; align-items: center;"><input type="checkbox" name="meta-tag" value="ãƒ‡ãƒãƒƒã‚°" style="margin-right: 5px;"> ãƒ‡ãƒãƒƒã‚°</label>
              <label style="display: flex; align-items: center;"><input type="checkbox" name="meta-tag" value="ä½œå“ç´¹ä»‹" style="margin-right: 5px;"> ä½œå“ç´¹ä»‹</label>
              <label style="display: flex; align-items: center;"><input type="checkbox" name="meta-tag" value="å‹Ÿé›†" style="margin-right: 5px;"> å‹Ÿé›†</label>
            </div>

            <p style="font-size: 12px; color: #666; margin: 5px 0;"><strong>ğŸ“– é›£æ˜“åº¦</strong></p>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
              <label style="display: flex; align-items: center;"><input type="checkbox" name="meta-tag" value="å…¥é–€" style="margin-right: 5px;"> å…¥é–€</label>
              <label style="display: flex; align-items: center;"><input type="checkbox" name="meta-tag" value="ä¸­ç´š" style="margin-right: 5px;"> ä¸­ç´š</label>
              <label style="display: flex; align-items: center;"><input type="checkbox" name="meta-tag" value="å¿œç”¨" style="margin-right: 5px;"> å¿œç”¨</label>
            </div>
          </div>
          <label style="display: block; margin-top: 8px; font-size: 13px; color: #666;">ã‚«ã‚¹ã‚¿ãƒ ã‚¿ã‚°ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰:</label>
          <input type="text" id="meta-custom-tags" placeholder="ä¾‹: æœ€é©åŒ–, åˆå¿ƒè€…å‘ã‘"
                 style="width: 100%; padding: 8px 10px; border: 1px solid #ced4da; border-radius: 4px; font-size: 14px;">
          <small style="color: #666; font-size: 11px;">æ¨å¥¨ã‚¿ã‚°ä»¥å¤–ã®ã‚¿ã‚°ã‚’è¿½åŠ ã—ãŸã„å ´åˆã¯ã€ã“ã“ã«ã‚«ãƒ³ãƒã§åŒºåˆ‡ã£ã¦å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</small>
        </div>
        <div class="metadata-field full-width">
          <label for="meta-summary">æ¦‚è¦ <span style="color: red;">*</span></label>
          <textarea id="meta-summary" rows="2" placeholder="è¨˜äº‹ã®æ¦‚è¦"></textarea>
        </div>
      </div>
    </div>

    <!-- æœ¬æ–‡ã‚¨ãƒ‡ã‚£ã‚¿ -->
    <div id="editor"></div>
  </div>
</div>

<!-- Toast UI Editor -->
<link rel="stylesheet" href="https://uicdn.toast.com/editor/latest/toastui-editor.min.css" />
<script src="https://uicdn.toast.com/editor/latest/toastui-editor-all.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Toast UI Editorã‚’åˆæœŸåŒ–
  const editor = new toastui.Editor({
    el: document.querySelector('#editor'),
    height: '600px',
    initialEditType: 'wysiwyg',
    previewStyle: 'vertical',
    initialValue: '## ã¯ã˜ã‚ã«\n\nã“ã“ã«è¨˜äº‹ã®æœ¬æ–‡ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚',
    language: 'ja-JP',
    toolbarItems: [
      ['heading', 'bold', 'italic', 'strike'],
      ['hr', 'quote'],
      ['ul', 'ol', 'task', 'indent', 'outdent'],
      ['table', 'link', 'image'],
      ['code', 'codeblock'],
      ['scrollSync'],
    ],
    hooks: {
      addImageBlobHook: (blob, callback) => {
        alert('ç”»åƒã¯ç›´æ¥GitHubã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚');
        callback('', '');
      }
    }
  });

  // ä¿å­˜ãƒœã‚¿ãƒ³ã®å‡¦ç†
  document.getElementById('save-button').addEventListener('click', async function() {
    const bodyContent = editor.getMarkdown();

    // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
    const filename = document.getElementById('meta-filename').value.trim();
    const title = document.getElementById('meta-title').value.trim();
    const author = document.getElementById('meta-author').value.trim();
    const summary = document.getElementById('meta-summary').value.trim();

    // ã‚¿ã‚°ã‚’åé›†ï¼ˆãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ + ã‚«ã‚¹ã‚¿ãƒ ã‚¿ã‚°ï¼‰
    const selectedTags = [];
    document.querySelectorAll('input[name="meta-tag"]:checked').forEach(cb => {
      selectedTags.push(cb.value);
    });
    const customTags = document.getElementById('meta-custom-tags').value.trim();
    if (customTags) {
      customTags.split(',').forEach(tag => {
        const trimmed = tag.trim();
        if (trimmed) selectedTags.push(trimmed);
      });
    }

    // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    if (!filename) {
      alert('ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
      return;
    }

    // ãƒ•ã‚¡ã‚¤ãƒ«åã®æ¤œè¨¼
    const filenameRegex = /^[a-zA-Z0-9_-]+$/;
    if (!filenameRegex.test(filename)) {
      alert('ãƒ•ã‚¡ã‚¤ãƒ«åã¯è‹±æ•°å­—ã€ãƒã‚¤ãƒ•ãƒ³ï¼ˆ-ï¼‰ã€ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ï¼ˆ_ï¼‰ã®ã¿ä½¿ç”¨ã§ãã¾ã™ã€‚');
      return;
    }

    if (!title || !author || !summary) {
      alert('ã‚¿ã‚¤ãƒˆãƒ«ã€è‘—è€…ã€æ¦‚è¦ã¯å¿…é ˆã§ã™ã€‚');
      return;
    }

    if (!bodyContent.trim()) {
      alert('æœ¬æ–‡ãŒç©ºã§ã™ã€‚');
      return;
    }

    if (selectedTags.length === 0) {
      alert('æœ€ä½1ã¤ä»¥ä¸Šã®ã‚¿ã‚°ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
      return;
    }

    // ç¾åœ¨ã®æ—¥ä»˜ã‚’å–å¾—
    const now = new Date();
    const year = now.getFullYear();
    const month = String(now.getMonth() + 1).padStart(2, '0');
    const day = String(now.getDate()).padStart(2, '0');
    const dateStr = year + '-' + month + '-' + day;

    const hours = String(now.getHours()).padStart(2, '0');
    const minutes = String(now.getMinutes()).padStart(2, '0');
    const seconds = String(now.getSeconds()).padStart(2, '0');
    const datetimeStr = dateStr + ' ' + hours + ':' + minutes + ':' + seconds + ' +09:00';

    // ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ç”Ÿæˆ
    const fullFilename = dateStr + '-' + filename + '.md';

    // Front Matterã‚’ç”Ÿæˆ
    let frontMatter = '---\n';
    frontMatter += 'layout: post\n';
    frontMatter += 'title: ' + title + '\n';
    frontMatter += 'date: ' + datetimeStr + '\n';
    frontMatter += 'author: ' + author + '\n';
    frontMatter += 'tags: [' + selectedTags.join(', ') + ']\n';
    frontMatter += 'summary: ' + summary + '\n';
    frontMatter += '---\n\n';

    // å®Œå…¨ãªMarkdownã‚’ç”Ÿæˆ
    const fullContent = frontMatter + bodyContent;

    // ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
    try {
      await navigator.clipboard.writeText(fullContent);

      // GitHubã®æ–°è¦ä½œæˆURLã‚’ç”Ÿæˆ
      const githubNewUrl = `https://github.com/Velgail/HSP-Knowledge/new/main/_posts?filename=${encodeURIComponent(fullFilename)}`;

      // ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
      if (confirm('âœ… è¨˜äº‹ã®å†…å®¹ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼\n\nGitHubã®æ–°è¦ä½œæˆãƒšãƒ¼ã‚¸ã‚’é–‹ãã¾ã™ã®ã§ã€ã‚¨ãƒ‡ã‚£ã‚¿å†…ã§ Ctrl+Vï¼ˆãƒšãƒ¼ã‚¹ãƒˆï¼‰ã—ã¦ãã ã•ã„ã€‚\n\nãƒ•ã‚¡ã‚¤ãƒ«å: ' + fullFilename)) {
        const newWindow = window.open(githubNewUrl, '_blank');

        // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãƒ–ãƒ­ãƒƒã‚¯å¯¾ç­–
        if (!newWindow || newWindow.closed || typeof newWindow.closed === 'undefined') {
          // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚ŒãŸå ´åˆ
          const fallbackLink = document.createElement('a');
          fallbackLink.href = githubNewUrl;
          fallbackLink.target = '_blank';
          fallbackLink.textContent = 'GitHubã®æ–°è¦ä½œæˆãƒšãƒ¼ã‚¸ã‚’é–‹ã';
          fallbackLink.style.cssText = 'display: inline-block; padding: 12px 24px; background: #1a73e8; color: white; text-decoration: none; border-radius: 6px; margin-top: 16px;';

          const message = document.createElement('div');
          message.style.cssText = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 32px; border-radius: 8px; box-shadow: 0 4px 16px rgba(0,0,0,0.2); z-index: 10000; text-align: center;';
          message.innerHTML = '<p style="margin: 0 0 16px; font-size: 16px;">âš ï¸ ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã—ãŸ</p><p style="margin: 0 0 16px; color: #666;">ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦GitHubã‚’é–‹ã„ã¦ãã ã•ã„</p>';
          message.appendChild(fallbackLink);

          const overlay = document.createElement('div');
          overlay.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 9999;';
          overlay.onclick = function() {
            document.body.removeChild(overlay);
            document.body.removeChild(message);
          };

          document.body.appendChild(overlay);
          document.body.appendChild(message);
        }
      }
    } catch (err) {
      alert('âš ï¸ ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¸ã®ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\nãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚\n\nã‚¨ãƒ©ãƒ¼: ' + err.message);
      console.error('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼:', err);
    }
  });
});
</script>
